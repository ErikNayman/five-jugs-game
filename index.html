<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>5 –ö—É–≤—à–∏–Ω–æ–≤ ‚Äî –ò–≥—Ä–∞</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
<div id="start-screen" class="min-h-screen flex flex-col items-center justify-center p-6">
  <h1 class="text-4xl font-bold mb-6 text-center">üè∫ 5 –ö—É–≤—à–∏–Ω–æ–≤</h1>
  <div class="bg-white p-6 rounded shadow w-full max-w-sm space-y-4 text-center">
    <h2 class="text-xl font-semibold mb-2">–í—ã–±–µ—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–≥—Ä—ã:</h2>
    <button onclick="startGame(24)" class="w-full bg-green-600 text-white p-2 rounded hover:bg-green-700">24 –º–µ—Å—è—Ü–∞</button>
    <button onclick="startGame(36)" class="w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700">36 –º–µ—Å—è—Ü–µ–≤</button>
  </div>
</div>

<div id="game-screen" class="hidden p-6 space-y-4 max-w-2xl mx-auto">
  <div class="grid grid-cols-2 gap-4">
    <div>
      <label class="block font-semibold mb-1">–¢—Ä–∞—Ç—ã –Ω–∞ –≤—ã–∂–∏–≤–∞–Ω–∏–µ ($)</label>
      <input id="survival" type="number" class="w-full border p-2 rounded" value="500">
    </div>
    <div>
      <label class="block font-semibold mb-1">–¢—Ä–∞—Ç—ã –Ω–∞ –∫–æ–º—Ñ–æ—Ä—Ç ($)</label>
      <input id="comfort" type="number" class="w-full border p-2 rounded" value="500">
    </div>
    <div>
      <label class="block font-semibold mb-1">–ù–∞ —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è ($)</label>
      <input id="save" type="number" class="w-full border p-2 rounded" value="0">
    </div>
    <div>
      <label class="block font-semibold mb-1">–ù–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ ($)</label>
      <input id="invest" type="number" class="w-full border p-2 rounded" value="0">
    </div>
    <div>
      <label class="block font-semibold mb-1">–ù–∞ –∑–¥–æ—Ä–æ–≤—å–µ ($)</label>
      <input id="healthSpend" type="number" class="w-full border p-2 rounded" value="0">
    </div>
    <div>
      <label class="block font-semibold mb-1">–ù–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ ($)</label>
      <input id="edu" type="number" class="w-full border p-2 rounded" value="0">
    </div>
    <div class="col-span-2">
      <label class="block font-semibold mb-1">–†–∞–±–æ—Ç–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ?</label>
      <select id="extra" class="w-full border p-2 rounded">
        <option value="–Ω–µ—Ç">–ù–µ—Ç</option>
        <option value="–¥–∞">–î–∞</option>
      </select>
    </div>
  </div>

  <button onclick="runTurn()" class="w-full mt-4 bg-blue-600 text-white font-bold py-2 rounded hover:bg-blue-700">–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ö–æ–¥</button>

  <div class="text-center space-y-2 mt-4">
    <p>–•–æ–¥: <span id="turn">0</span> / <span id="maxTurns">0</span></p>
    <p>–°–æ–±—ã—Ç–∏–µ: <span id="event">-</span></p>
    <p>–°–≤–æ–±–æ–¥–Ω—ã–µ –¥–µ–Ω—å–≥–∏: <span id="free">$0</span></p>
    <p>–°–±–µ—Ä–µ–∂–µ–Ω–∏—è: <span id="savings">$0</span></p>
    <p>–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏: <span id="investments">$0</span></p>
    <p>–ó–¥–æ—Ä–æ–≤—å–µ: <span id="healthResult">100%</span></p>
    <p>–°—á–∞—Å—Ç—å–µ: <span id="happinessResult">90%</span></p>
  </div>
</div>

<div id="end-screen" class="hidden min-h-screen flex flex-col items-center justify-center p-6 text-center">
  <h1 class="text-4xl font-bold mb-6">üèÅ –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</h1>
  <div class="bg-white p-6 rounded shadow w-full max-w-md space-y-4">
    <p id="endReason"></p>
    <p><strong>–ò—Ç–æ–≥–æ–≤—ã–µ —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è:</strong> <span id="finalSavings">$0</span></p>
    <p><strong>–ò—Ç–æ–≥–æ–≤—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏:</strong> <span id="finalInvestments">$0</span></p>
    <p><strong>–ó–¥–æ—Ä–æ–≤—å–µ:</strong> <span id="finalHealth">0%</span></p>
    <p><strong>–°—á–∞—Å—Ç—å–µ:</strong> <span id="finalHappiness">0%</span></p>
    <p><strong>–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ –≤ –º–µ—Å—è—Ü:</strong> <span id="finalPassiveIncome">$0</span></p>
    <p><strong>–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</strong> <span id="finalScore">0 –±–∞–ª–ª–æ–≤</span></p>
    <p><strong>–¢–≤–æ–π —Ç–∏—Ç—É–ª:</strong> <span id="finalTitle">-</span></p>
    <button onclick="location.reload()" class="mt-4 bg-green-600 text-white p-2 rounded hover:bg-green-700">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
  </div>
</div>

<script>
let savings_total = 0;
let investments_total = 0;
let health = 100;
let happiness = 90;
const income_base = 1000;
const base_survival = 500;
const base_comfort = 500;
let maxTurns = 0;
let currentTurn = 0;

function startGame(turns) {
  maxTurns = turns;
  document.getElementById('maxTurns').innerText = turns;
  document.getElementById('start-screen').classList.add('hidden');
  document.getElementById('game-screen').classList.remove('hidden');
}

function runTurn() {
  currentTurn++;
  const survival = parseFloat(document.getElementById('survival').value);
  const comfort = parseFloat(document.getElementById('comfort').value);
  const save = parseFloat(document.getElementById('save').value);
  const invest = parseFloat(document.getElementById('invest').value);
  const healthSpend = parseFloat(document.getElementById('healthSpend').value);
  const edu = parseFloat(document.getElementById('edu').value);
  const extra = document.getElementById('extra').value;

  let income = income_base;
  if (extra === "–¥–∞") income += 200;

  let event = "–Ω–∏—á–µ–≥–æ";
  let random = Math.random();
  let crisisLoss = 0;
  let expensePenalty = 0;
  let healthPenalty = 0;

  if (random < 0.10) {
    event = "–º–µ–ª–∫–∞—è —Ç—Ä–∞—Ç–∞ ‚Äì$50";
    expensePenalty = -50;
  } else if (random < 0.20) {
    event = "–º–∏–Ω–∏-–∫—Ä–∏–∑–∏—Å: –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ ‚Äì6%";
    crisisLoss = investments_total * 0.06;
  } else if (random < 0.25) {
    event = "–±–æ–ª–µ–∑–Ω—å ‚Äì10% –∑–¥–æ—Ä–æ–≤—å—è";
    healthPenalty = 0.10 * base_survival;
  }

  const totalSpent = survival + comfort + save + invest + healthSpend + edu;
  const free = income - totalSpent;

  savings_total += save + free + expensePenalty;
  const growth = Math.random() <= 0.7 ? Math.random()*0.03 : Math.random()*-0.01;
  investments_total = (investments_total + invest - crisisLoss) * (1 + growth);

  if (comfort < base_comfort) happiness -= ((base_comfort - comfort) / base_comfort) * 10;
  if (extra === "–¥–∞") happiness -= 0.01 * base_survival;
  happiness = Math.max(0, happiness);

  if (survival < base_survival) health -= ((base_survival - survival) / base_survival) * 100;
  health += (healthSpend / base_survival) * 50;
  if (extra === "–¥–∞") health -= 0.02 * base_survival;
  health -= healthPenalty;
  if (survival >= base_survival) health += base_survival / 100;
  if (happiness >= 90) health += base_survival / 100;
  health = Math.max(0, Math.min(100, health));

  document.getElementById('turn').innerText = currentTurn;
  document.getElementById('event').innerText = event;
  document.getElementById('free').innerText = `$${Math.round(free)}`;
  document.getElementById('savings').innerText = `$${Math.round(savings_total)}`;
  document.getElementById('investments').innerText = `$${Math.round(investments_total)}`;
  document.getElementById('healthResult').innerText = `${Math.round(health)}%`;
  document.getElementById('happinessResult').innerText = `${Math.round(happiness)}%`;

  if (health <= 0 || happiness <= 0 || currentTurn >= maxTurns) {
    let reason = "–¢—ã –∑–∞–≤–µ—Ä—à–∏–ª –≤—Å–µ —Ö–æ–¥—ã.";
    if (health <= 0) reason = "–¢—ã –ø–æ—Ç–µ—Ä—è–ª –∑–¥–æ—Ä–æ–≤—å–µ. –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞.";
    if (happiness <= 0) reason = "–¢—ã –ø–æ—Ç–µ—Ä—è–ª —Å—á–∞—Å—Ç—å–µ. –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞.";
    finishGame(reason);
  }
}

function finishGame(reasonText = "–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.") {
  document.getElementById('game-screen').classList.add('hidden');
  document.getElementById('end-screen').classList.remove('hidden');
  document.getElementById('endReason').innerText = reasonText;

  const passiveIncome = (investments_total*0.05 + savings_total*0.03) / 12;
  let score = 0;
  score += Math.floor(savings_total / 1000);
  score += Math.floor(investments_total / 1000) * 2;
  if (health > 70) score += 20;
  if (happiness > 70) score += 20;
  if (passiveIncome > 1000) score += 30;

  let title = "–ù–æ–≤–∏—á–æ–∫";
  if (score >= 80) title = "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –º–∞–≥–Ω–∞—Ç";
  else if (health > 90) title = "–ó–¥–æ—Ä–æ–≤—è–∫";
  else if (happiness > 90) title = "–°—á–∞—Å—Ç–ª–∏–≤—á–∏–∫";
  else if (health < 30) title = "–í—ã–∂–∏–≤—à–∏–π";

  document.getElementById('finalSavings').innerText = `$${Math.round(savings_total)}`;
  document.getElementById('finalInvestments').innerText = `$${Math.round(investments_total)}`;
  document.getElementById('finalHealth').innerText = `${Math.round(health)}%`;
  document.getElementById('finalHappiness').innerText = `${Math.round(happiness)}%`;
  document.getElementById('finalPassiveIncome').innerText = `$${Math.round(passiveIncome)}`;
  document.getElementById('finalScore').innerText = `${score} –±–∞–ª–ª–æ–≤`;
  document.getElementById('finalTitle').innerText = title;
}
</script>
</body>
</html>